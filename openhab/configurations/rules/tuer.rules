import org.openhab.script.actions.*

/* Regeln, die bisher nur Notifications an das Smartphone senden und
 * ein bisschen dynamisch die Sitemap ändern.
 *
 * Um die Notifications zu erhalten, muss man das Addon my.openhab
 * installieren und da auch einen Account haben und die entsprechende
 * Email hier eintragen. Anschließend nur noch Benutzername und PW und
 * https://my.openhab.org als Remote URL in der App setzen.
 * Die App funktioniert dann auch ortsunabhängig, egal ob WLAN oder Mobilfunk.
 */

rule klingeln
when
	Item taster changed from OPEN to CLOSED
then
	//logInfo("test", "HAHAHA GPIO 22 changed to "+ taster.state)
        //sendBroadcastNotification("GPIO 22 changed to "+ taster.state)
        //sendCommand(camSwitch, ON)
	sendCommand(LED2,ON)
	Thread::sleep(10000)
	sendCommand(LED2,OFF)
end





rule tuerOeffnen
when
        Item tuerSwitch received command ON
then
        sendBroadcastNotification("Tür geöffnet")
        sendCommand(raspiLED, ON)	//Tür öffnen
end

rule tuerSchliessen
when
        Item tuerSwitch received command OFF
then
        sendBroadcastNotification("Tür geschlossen")
        sendCommand(raspiLED, OFF)	//Tür schließen?
end

rule streamStarten
when
        Item camSwitch received command ON
then
        sendBroadcastNotification("Stream gestartet")
        //Stream Starten
end

rule streamBeenden
when
        Item camSwitch received command OFF
then
        sendBroadcastNotification("Stream beendet")
        //Stream beenden
end

rule microAn
when
        Item microSwitch received command ON
then
        sendBroadcastNotification("Micro an")
        //Micro anschalten
end

rule microAus
when
        Item microSwitch received command OFF
then
        sendBroadcastNotification("Micro aus")
        //Micro ausschalten
end

rule testAn
when
	Item testSwitch received command ON
then
	//say("Hallo Welt")
	executeCommandLine(" /opt/openhab/configurations/scripts/speech.sh Ich bin gleich da")
end

rule testAus
when
	Item testSwitch received command OFF
then
	//say("Bye Welt")
	executeCommandLine(" /opt/openhab/configurations/scripts/speech.sh Geh weg")
end

rule sagen
when
	Item VoiceCommand received command
then
	logInfo("Voice.Rec","VoiceCommand received "+VoiceCommand.state.toString)
	executeCommandLine(" /opt/openhab/configurations/scripts/speech.sh " + VoiceCommand.state.toString)
end

rule textSagen
when
	Item TextInput changed
then
	executeCommandLine(" /opt/openhab/configurations/scripts/speech.sh Hallo " + TextInput.state.toString)
	logInfo("Voice.Rec","VoiceCommand received "+VoiceCommand.state.toString)
end

rule auswahlBox
when
	Item sage received command
then
	switch(receivedCommand)
	{
		case 0: executeCommandLine( " /opt/openhab/configurations/scripts/speech.sh Bin gleich da")
		case 1: executeCommandLine( " /opt/openhab/configurations/scripts/speech.sh Bin nicht zu Hause")
		case 2: executeCommandLine( " /opt/openhab/configurations/scripts/speech.sh Bin in einer Stunde da")
		case 3: executeCommandLine( " /opt/openhab/configurations/scripts/speech.sh Stellen sie es in der Garage ab")
	}
end
